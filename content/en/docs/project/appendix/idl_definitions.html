<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>IDL definitions</title>
<style>
@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";
@import "https://cdn.jsdelivr.net/gh/asciidoctor/asciidoctor@2.0/data/stylesheets/asciidoctor-default.css";

h6 > .content > .title,h7,h8,h9 {
    font-family:"Open Sans","DejaVu Sans",sans-serif;
    font-weight:normal;
    font-size:.85em;
    font-style:normal;
    color:#ba8425;
    text-rendering:optimizeLegibility;
    margin-top:1em;
    margin-bottom:1em;
    line-height:2em
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article">
<div id="header">
<h1>IDL definitions</h1>
</div>
<div id="content">
<div class="paragraph">
<p>Because of differences between ORBs, and errors in certain ORBs, the idl available with Narayana may differ from that shown below.
You should always inspect the idl files prior to implementation to determine what, if any, differences exist.</p>
</div>
<div class="listingblock">
<div class="title">CosTransactions.idl</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="C"><span class="preprocessor">#ifndef</span> COSTRANSACTIONS_IDL_
<span class="preprocessor">#define</span> COSTRANSACTIONS_IDL_
module CosTransactions {
    <span class="keyword">enum</span> Status {
        StatusActive, StatusMarkedRollback, StatusPrepared,
        StatusCommitted, StatusRolledback, StatusUnknown,
        StatusPreparing, StatusCommitting, StatusRollingBack,
        StatusNoTransaction
    };

    <span class="keyword">enum</span> Vote { VoteCommit, VoteRollback, VoteReadOnly };
    <span class="comment">// Standard exceptions - some Orb supports them</span>
    exception TransactionRequired {};
    exception TransactionRolledBack {};
    exception InvalidTransaction {};
    <span class="comment">// Heuristic exceptions</span>
    exception HeuristicRollback {};
    exception HeuristicCommit {};
    exception HeuristicMixed {};
    exception HeuristicHazard {};
    <span class="comment">// Exception from ORB</span>
    exception WrongTransaction {};
    <span class="comment">// Other transaction related exceptions</span>
    exception SubtransactionsUnavailable {};
    exception NotSubtransaction {};
    exception Inactive {};
    exception NotPrepared {};
    exception NoTransaction {};
    exception InvalidControl {};
    exception Unavailable {};
    exception SynchronizationUnavailable {};
    <span class="comment">// Forward references for later interfaces</span>
    interface Control;
    interface Terminator;
    interface Coordinator;
    interface Resource;
    interface RecoveryCoordinator;
    interface SubtransactionAwareResource;
    interface TransactionFactory;
    interface TransactionalObject;
    interface Current;
    interface Synchronization;

    <span class="comment">// Formally part of CosTSInteroperation</span>
    <span class="keyword">struct</span> otid_t {
        <span class="predefined-type">long</span> formatID;
        <span class="predefined-type">long</span> bequal_length;
        sequence &lt;octet&gt; tid;
    };

    <span class="keyword">struct</span> TransIdentity {
        Coordinator coord;
        Terminator term;
        otid_t otid;
    };

    <span class="keyword">struct</span> PropagationContext{
       <span class="predefined-type">unsigned</span> <span class="predefined-type">long</span> timeout;
        TransIdentity currentTransaction;
        sequence &lt;TransIdentity&gt; parents;
        any implementation_specific_data;
    };

    interface Current : CORBA::Current {
        <span class="directive">void</span> begin () raises (SubtransactionsUnavailable);
        <span class="directive">void</span> commit (in boolean report_heuristics) raises (NoTransaction, HeuristicMixed, HeuristicHazard, TransactionRolledBack);
        <span class="directive">void</span> rollback () raises (NoTransaction);
        <span class="directive">void</span> rollback_only () raises (NoTransaction);

        Status get_status ();
        string get_transaction_name ();
        <span class="directive">void</span> set_timeout (in <span class="predefined-type">unsigned</span> <span class="predefined-type">long</span> seconds);

        Control get_control ();
        Control suspend ();
        <span class="directive">void</span> resume (in Control which) raises (InvalidControl);
    };

    interface TransactionFactory{
        Control create (in <span class="predefined-type">unsigned</span> <span class="predefined-type">long</span> time_out);
        Control recreate (in PropagationContext ctx);
    };
    interface Control {
        Terminator get_terminator () raises (Unavailable);
        Coordinator get_coordinator () raises (Unavailable);
    };

    interface Terminator{
        <span class="directive">void</span> commit (in boolean report_heuristics) raises (HeuristicMixed, HeuristicHazard, TransactionRolledBack);
        <span class="directive">void</span> rollback ();
    };

    interface Coordinator {
        Status get_status ();
        Status get_parent_status ();
        Status get_top_level_status ();

        boolean is_same_transaction (in Coordinator tc);
        boolean is_related_transaction (in Coordinator tc);
        boolean is_ancestor_transaction (in Coordinator tc);
        boolean is_descendant_transaction (in Coordinator tc);
        boolean is_top_level_transaction ();

        <span class="predefined-type">unsigned</span> <span class="predefined-type">long</span> hash_transaction ();
        <span class="predefined-type">unsigned</span> <span class="predefined-type">long</span> hash_top_level_tran ();

        RecoveryCoordinator register_resource (in Resource r) raises (Inactive);
        <span class="directive">void</span> register_synchronization (in Synchronization sync) raises (Inactive, SynchronizationUnavailable);
        <span class="directive">void</span> register_subtran_aware (in SubtransactionAwareResource r) raises (Inactive, NotSubtransaction);

        <span class="directive">void</span> rollback_only () raises (Inactive);

        string get_transaction_name ();

        Control create_subtransaction () raises (SubtransactionsUnavailable, Inactive);

        PropagationContext get_txcontext () raises (Unavailable);
    };

    interface RecoveryCoordinator {
        Status replay_completion (in Resource r) raises (NotPrepared);
    };

    interface Resource {
        Vote prepare () raises (HeuristicMixed, HeuristicHazard);
        <span class="directive">void</span> rollback () raises (HeuristicCommit, HeuristicMixed, HeuristicHazard);
        <span class="directive">void</span> commit () raises (NotPrepared, HeuristicRollback, HeuristicMixed, HeuristicHazard);
        <span class="directive">void</span> commit_one_phase () raises (HeuristicHazard);
        <span class="directive">void</span> forget ();
    };

    interface SubtransactionAwareResource : Resource {
        <span class="directive">void</span> commit_subtransaction (in Coordinator parent);
        <span class="directive">void</span> rollback_subtransaction ();
    };

    interface TransactionalObject {
    };

    interface Synchronization : TransactionalObject {
        <span class="directive">void</span> before_completion ();
        <span class="directive">void</span> after_completion (in Status s);
    };
};
<span class="preprocessor">#endif</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">ArjunaOTS.IDL</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="C"><span class="preprocessor">#ifndef</span> ARJUNAOTS_IDL_
<span class="preprocessor">#define</span> ARJUNAOTS_IDL_

<span class="preprocessor">#include</span> <span class="include">&lt;idl/CosTransactions.idl&gt;</span>
module ArjunaOTS {
    exception ActiveTransaction {};
    exception BadControl {};
    exception Destroyed {};
    exception ActiveThreads {};
    exception InterpositionFailed {};

    interface UidCoordinator : CosTransactions::Coordinator {
        readonly attribute string uid;
        readonly attribute string topLevelUid;
    };

    interface ActionControl : CosTransactions::Control {
        CosTransactions::Control getParentControl () raises (CosTransactions::Unavailable, CosTransactions::NotSubtransaction);
        <span class="directive">void</span> destroy () raises (ActiveTransaction, ActiveThreads, BadControl, Destroyed);
    };

    interface ArjunaSubtranAwareResource : CosTransactions::SubtransactionAwareResource {
        CosTransactions::Vote prepare_subtransaction ();
    };

    interface ArjunaTransaction : UidCoordinator, CosTransactions::Terminator {
    };

    interface OTSAbstractRecord : ArjunaSubtranAwareResource {
        readonly attribute <span class="predefined-type">long</span> typeId;
        readonly attribute string uid;

        boolean propagateOnAbort ();
        boolean propagateOnCommit ();

        boolean saveRecord ();

        <span class="directive">void</span> merge (in OTSAbstractRecord record);
        <span class="directive">void</span> alter (in OTSAbstractRecord record);

        boolean shouldAdd (in OTSAbstractRecord record);
        boolean shouldAlter (in OTSAbstractRecord record);
        boolean shouldMerge (in OTSAbstractRecord record);
        boolean shouldReplace (in OTSAbstractRecord record);
    };
};</code></pre>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-10-16 15:47:44 +0200
</div>
</div>
</body>
</html>